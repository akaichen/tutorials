<hr>
<p>tag: tutorial
src: tutorial-12-sound-sensor.html
title: 聲音偵測點亮 LED 與網頁燈泡
banner: tutorial-12-01.jpg
img: tutorial-12-01s.jpg</p>
<h2>date: 20150603</h2>
<!-- @@master  = ../../_layout.html-->
<!-- @@block  =  meta-->
<title>範例教學 12：聲音偵測點亮 LED 與網頁燈泡 :::: Webduino = Web × Arduino</title>

<meta name="description" content="聲音偵測傳感器類似一個微型的麥克風，不過它的功能並不如麥克風一般的強大，主要作用為偵測是否有聲音，在聲音偵測傳感器上頭有一個小型的十字旋鈕，可以用螺絲起子旋轉調整零敏度，靈敏度如果太高，可能連同一些風吹草動的聲音都會偵測到，靈敏度過低可能拍手拍得再大聲都偵測不到。">

<meta itemprop="description" content="聲音偵測傳感器類似一個微型的麥克風，不過它的功能並不如麥克風一般的強大，主要作用為偵測是否有聲音，在聲音偵測傳感器上頭有一個小型的十字旋鈕，可以用螺絲起子旋轉調整零敏度，靈敏度如果太高，可能連同一些風吹草動的聲音都會偵測到，靈敏度過低可能拍手拍得再大聲都偵測不到。">

<meta property="og:description" content="聲音偵測傳感器類似一個微型的麥克風，不過它的功能並不如麥克風一般的強大，主要作用為偵測是否有聲音，在聲音偵測傳感器上頭有一個小型的十字旋鈕，可以用螺絲起子旋轉調整零敏度，靈敏度如果太高，可能連同一些風吹草動的聲音都會偵測到，靈敏度過低可能拍手拍得再大聲都偵測不到。">

<meta property="og:title" content="範例教學 12：聲音偵測點亮 LED 與網頁燈泡" >

<meta property="og:url" content="https://webduino.io/tutorials/tutorial-12-sound-sensor.html">

<meta property="og:image" content="https://webduino.io/img/tutorials/tutorial-12-01s.jpg">

<meta itemprop="image" content="https://webduino.io/img/tutorials/tutorial-12-01s.jpg">

<include src="../_include-tutorials.html"></include>

<!-- @@close-->
<!-- @@block  =  tutorials-->
<h1>範例教學 12：聲音偵測點亮 LED 與網頁燈泡</h1>
<p>聲音偵測傳感器類似一個微型的麥克風，不過它的功能並不如麥克風一般的強大，主要作用為偵測是否有聲音，在聲音偵測傳感器上頭有一個小型的十字旋鈕，可以用螺絲起子旋轉調整零敏度，靈敏度如果太高，可能連同一些風吹草動的聲音都會偵測到，靈敏度過低可能拍手拍得再大聲都偵測不到，而且由於聲音傳感器本身有傳輸的時間差，因此在接收到聲音後也會有些微的延遲現象。</p>
<p><br/></p>
<p>這個範例將會利用聲音偵測傳感器，當偵測到有聲音，就自動點亮 LED 燈，同時也會點亮網頁裡頭的燈泡。</p>
<h2>範例影片展示</h2>
<p><iframe class="youtube" src="https://www.youtube.com/embed/ljSZQkpIOh8" frameborder="0" allowfullscreen></iframe></p>
<h2>接線與實作</h2>
<ul>
<li><h3>1. 聲音偵測傳感器與 LED 燈</h3>
<p>  首先把聲音偵測傳感器和 LED 燈接在麵包板上，聲音偵測傳感器的 +5V 接在開發板的 VCC，GND 接在 GND，Out 則接在 10 的腳位，然後再用電線將 GND 引出給 LED 的短腳使用，LED 的長腳接在 9 的腳位。</p>
<p>  <img src="../img/tutorials/tutorial-12-02.jpg" alt=""></p>
</li>
<li><h3>2. 完成後的實際長相</h3>
<p>  <img src="../img/tutorials/tutorial-12-03.jpg" alt=""></p>
<p>  <img src="../img/tutorials/tutorial-12-04.jpg" alt=""></p>
</li>
</ul>
<h2>範例解析 (<a href="http://webduinoio.github.io/samples/content/sound-led/index.html">快速體驗</a>、<a href="http://bin.webduino.io/baka/edit?html,js,output">jsbin 範例</a>、<a href="https://webduino.io/device.html">檢查連線狀態</a>)</h2>
<p>在 head 的位置引入相對應的 javascript 以及 WebComponents，這裏我們用到了兩個元件的 WebComponents，分別是 <code>wa-sound.html</code> 和 <code>wa-led.html</code>。</p>
<pre><code>&lt;script src=&quot;https://webduino.io/components/webcomponentsjs/webcomponents.js&quot;&gt;&lt;/script&gt;
&lt;link rel=&#39;import&#39; href=&#39;https://webduino.io/components/webduino/web-arduino.html&#39; /&gt;
&lt;link rel=&#39;import&#39; href=&#39;https://webduino.io/components/webduino/wa-sound.html&#39; /&gt;
&lt;link rel=&#39;import&#39; href=&#39;https://webduino.io/components/webduino/wa-led.html&#39; /&gt;
</code></pre><p>接著就是在 body 裡頭放入必要的元素，除了 board 之外，多放上一個燈泡的區域，裡頭有兩張燈泡明暗的圖片，在聲音傳感器偵測到聲音觸發時，就會進行燈泡明暗的切換。</p>
<pre><code>&lt;div id=&#39;light&#39; class=&quot;off&quot;&gt;
  &lt;img src=&#39;http://i.imgur.com/T5H4MHE.png&#39;&gt;&lt;/img&gt;
  &lt;img src=&#39;http://i.imgur.com/8qFj2Ou.png&#39;&gt;&lt;/img&gt;
&lt;/div&gt;

&lt;web-arduino id=&#39;board&#39; device=&quot;你的 device 名稱&quot;&gt;
  &lt;wa-sound id=&#39;sound&#39; pin=&#39;10&#39;&gt;&lt;/wa-sound&gt;
  &lt;wa-led id=&#39;led&#39; pin=&#39;9&#39;&gt;&lt;/wa-led&gt;
&lt;/web-arduino&gt;
</code></pre><p>燈泡的切換主要由下列的這段 CSS 來控制。</p>
<pre><code>#light img{
  width:100%;
  display:none;
  max-width:300px;
}
#light.off img:first-child{
  display:inline-block;
}
#light.on img:last-child{
  display:inline-block;
}
</code></pre><p>最後就是 javascript 的部分，這邊我們用到了兩個 sound 元件的 API：<code>detected</code> 和 <code>ended</code>，這兩個 API 其實觸發的時間點有時候是很接近的，因為 detected 表示偵測到有聲音，ended 表示聲音結束，除非是連續的聲音，如果只有發出一聲或兩聲，聲音間隔也會被當作 ended，所以這裏額外新增一個計時器，利用 setTimeout 來做延遲，才可以偵測拍手的聲音。</p>
<pre><code>window.addEventListener(&#39;WebComponentsReady&#39;, function () {
  var board = document.getElementById(&#39;board&#39;);

  board.on(&#39;ready&#39;,function ready() {
    var  sound = document.getElementById(&#39;sound&#39;),
      led = document.getElementById(&#39;led&#39;),
      light = document.getElementById(&#39;light&#39;),
      timer;
      led.off();
      light.className = &#39;off&#39;;

      sound.on(&#39;detected&#39;, function () {
        clearTimeout(timer);
        led.on();
        light.className = &#39;on&#39;;
      });

      sound.on(&#39;ended&#39;, function () {
        timer = setTimeout(function(){
          led.off();
          light.className = &#39;off&#39;;
        },1000);
      });  

  });

}, false);
</code></pre><p>如果還有不清楚的，不妨利用這個 <a href="http://webduinoio.github.io/samples/content/sound-led/index.html">快速體驗</a>，輸入 device 號碼，拍拍手，看看燈泡與 LED 會不會一起發亮。</p>
<!-- @@close-->